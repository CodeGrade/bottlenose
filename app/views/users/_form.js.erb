$(function() {
  $("#nick_is_name").change(function() {
    $("#user_nickname").prop('readonly', $(this).prop('checked'));
    if ($(this).prop('checked'))
      $("#user_nickname").val($("#user_first_name").val());
  });
});
$("form").submit(ensureValidNumericInputOnSubmit);
$("input#user_profile").change(function(e) {
  try {
    var img = document.getElementById("profile_preview");
    img.src = window.URL.createObjectURL(this.files[0]);
    img.onload = function() {
      window.URL.revokeObjectURL(this.src);
    }
  } catch(exn) {
    // may not support the file APIs sufficiently
  }
});
